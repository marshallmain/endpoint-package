---
title: Elastic Endpoint Metadata Events
fields:
- name: "@timestamp"
  type: date
  description: >
    Date/time when the event originated. This is the date/time extracted from the event, typically representing
    when the event was generated by the source. If the event source has no original timestamp, this value is typically
    populated by the first time the event was received by the pipeline. Required field for all events.

- name: elastic
  description: > 
    Holds fields and properties of data points and concepts in the elastic domain or namespace. 
  
  fields:
  - name: agent
    description: >
      The agent fields contain data about the Elastic Agent. The Elastic Agent is the management agent
      that manages other agents or process on the host. 
    fields:
    - name: id
      description: >
        Unique identifier of this elastic agent (if one exists).
      type: keyword
      example: c2a9093e-e289-4c0a-aa44-8c32a414fa7a

- name: ecs
  title: ECS
  description: >
    Meta-information specific to ECS.
  fields:

    - name: version
      type: keyword
      description: >
        ECS version this event conforms to. `ecs.version` is a required field and must exist in all events.

        When querying across multiple indices -- which may conform to slightly
        different ECS versions -- this field lets integrations adjust to the
        schema version of the events.
      example: 1.0.0

- name: event
  description: >
    The event fields are used for context information about the event.
  fields:
  - name: created
    description: >
      event.created contains the date/time when the event was first read by the elastic endpoint agent, or by your pipeline.
    type: date
    example: 2015-01-01T12:10:30Z

- name: endpoint
  description: >
    The endpoint fields are used for custom information about the endpoint.
  fields:
  - name: artifacts
    description: >
      The artifacts that the endpoint has downloaded and applied with the policy
    fields:
      - name: global-manifest
        description: >
          Global manifest artifact
        fields:
        - name: version
          description: >
            The version of the global manifest
          type: keyword
          example:
            1.0.0
        - name: sha256
          description: >
            The hash of the artifact
          type: keyword
          example:
            5e7c4d821aae015726bb05abdb2b30b8e87cce39a83115425e642a3ab9fe262b
      - name: endpointpe-v4-windows
        description: >
          Artifact for Windows endpoint model
        fields:
        - name: version
          description: >
            The version of the Windows endpoint modelt
          type: keyword
          example:
            1.0.0
        - name: sha256
          description: >
            The hash of the artifact
          type: keyword
          example:
            5e7c4d821aae015726bb05abdb2b30b8e87cce39a83115425e642a3ab9fe262b
      - name: user-whitelist-windows
        description: >
          Artifact for the User whitelist
        fields:
        - name: version
          description: >
            The version of the User whitelist
          type: keyword
          example:
            1.0.0
        - name: sha256
          description: >
            The hash of the artifact
          type: keyword
          example:
            5e7c4d821aae015726bb05abdb2b30b8e87cce39a83115425e642a3ab9fe262b
      - name: global-whitelist-windows
        description: >
          Artifact for the global  whitelist
        fields:
        - name: version
          description: >
            The version of the global whitelist
          type: keyword
          example:
            1.0.0
        - name: sha256
          description: >
            The hash of the artifact
          type: keyword
          example:
            5e7c4d821aae015726bb05abdb2b30b8e87cce39a83115425e642a3ab9fe262b

  - name: policy
    description: >
      The policy fields are used to hold information about applied policies.
    fields:
    - name: applied
      description: >
        Information about the applied policy
      - name: id
        description: >
          The unique identifier of the policy
        type: keyword
        example: c2a9093e-e289-4c0a-aa44-8c32a414fa7a

      - name: version
        description: >
          The revision of the policy
        type: keyword
        example: 1.0.0 

      - name: status
        description: >
          The overall status of the policy
        type: keyword
        example:
          success
          warning
          failure

      - name: response
        description: >
          The response of this instance of the policy application
        fields:
        - name: configurations
          description: >
            The list of configurations that were set by this policy application
          fields:
          - name: malware
            description: >
              The details of the application of the malware configuration
            fields:
            - name: status
              description: >
                The status of the malware configuration
              type: keyword
              example:
                success
                warning
                failure
            - name: concerned_actions 
              description: >
                The actions taken by endpoint to apply the configurations for malware
              type: keyword
              example:
                ingest_malware_config
                download_model
          - name: events
            description: >
              The details of the application of the eventing configuration
            fields:
            - name: status
              description: >
                The status of the eventing configuration
              type: keyword
              example:
                success
                warning
                failure
            - name: concerned_actions 
              description: >
                The actions taken by endpoint to apply the configurations for eventing
              type: keyword
              example:
                ingest_eventing_config
                download_model
          - name: logging
            description: >
              The details of the application of the logging configuration
            fields:
            - name: status
              description: >
                The status of the eventing configuration
              type: keyword
              example:
                success
                warning
                failure
            - name: concerned_actions 
              description: >
                The actions taken by endpoint to apply the configurations for logging
              type: keyword
              example:
                load_config
                configure_logging
          - name: streaming
            description: >
              The details of the application of the streaming configuration
            fields:
            - name: status
              description: >
                The status of the eventing configuration
              type: keyword
              example:
                success
                warning
                failure
            - name: concerned_actions 
              description: >
                The actions taken by endpoint to apply the configurations for streaming
              type: keyword
              example:
                load_config
                read_elasticsearch_config
        - name: actions
          description: >
            The list of all actions taken by the endpoint to apply this policy
          fields:
          - name: version_check
            description: >
              A version check for the policy
            fields:
            - name: status
              description: >
                The status of this action
              type: keyword
              example:
                success
                warning
                failure
            - name: message
              description: >
                A message describing the status results
              type: text
              example: version not verified

          #TODO this list of actions should be permissive as the actions taken can change rapidly.

- name: agent
  description: >
    The agent fields contain data about the Elastic Endpoint Agent (Endpoint Agent).
  fields:
  - name: version
    description: >
      version of the elastic endpoint agent.
    type: keyword
    example: 6.0.0-rc2

  - name: id
    description: >
      Unique identifier of this elastic endpoint agent (if one exists).
    type: keyword
    example: 8a4f500d
  - name: type
    description: >
      Endpoint.
    type: keyword
    example: endpoint

  - name: build
    description: >
      Build info for the endpoint
    fields:
      - name: original
        description: >
          Extended build info for the endpoint
        type: keyword
        example:
          metricbeat version 7.6.0 (amd64), libbeat 7.6.0 [6a23e8f8f30f5001ba344e4e54d8d9cb82cb107c built 2020-02-05 23:10:10 +0000 UTC]
  
