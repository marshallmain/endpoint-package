---
title: Elastic Endpoint Metadata Events
fields:
- name: "@timestamp"
  type: date
  description: >
    Date/time when the event originated. This is the date/time extracted from the event, typically representing
    when the event was generated by the source. If the event source has no original timestamp, this value is typically
    populated by the first time the event was received by the pipeline. Required field for all events.

- name: elastic
  description: > 
    Holds fields and properties of data points and concepts in the elastic domain or namespace. 
  
  fields:
  - name: agent
    description: >
      The agent fields contain data about the Elastic Agent. The Elastic Agent is the management agent
      that manages other agents or process on the host. 
    fields:
    - name: id
      description: >
        Unique identifier of this elastic agent (if one exists).
      type: keyword
      example: c2a9093e-e289-4c0a-aa44-8c32a414fa7a

- name: ecs
  title: ECS
  description: >
    Meta-information specific to ECS.
  fields:

    - name: version
      type: keyword
      description: >
        ECS version this event conforms to. `ecs.version` is a required field and must exist in all events.

        When querying across multiple indices -- which may conform to slightly
        different ECS versions -- this field lets integrations adjust to the
        schema version of the events.
      example: 1.0.0

- name: event
  description: >
    The event fields are used for context information about the event.
  fields:
  - name: created
    description: >
      event.created contains the date/time when the event was first read by the elastic endpoint agent, or by your pipeline.
    type: date
    example: 2015-01-01T12:10:30Z

- name: endpoint
  description: >
    The endpoint fields are used for custom information about the endpoint.
  fields:
  - name: policy
    description: >
      The policy fields are used to hold information about applied policy.
    fields:
    - name: id
      description: >
        The unique identifier of the policy
      type: keyword
      example: c2a9093e-e289-4c0a-aa44-8c32a414fa7a

    - name: version
      description: >
        The revision of the policy
      type: keyword
      example: c2a9093e-e289-4c0a-aa44-8c32a414fa7a

    - name: response
      description: >
        The response of this instance of the policy application
      fields:
      - name: configurations
        description: >
          The list of configurations that were set by this policy application
        fields:
        - name: malware
          description: >
            The details of the application of the malware configuration
          fields:
          - name: status
            description: >
              The status of the malware configuration
            type: keyword
            example: failure
          - name: concerned_actions #TODO we can define each action
            description: >
              The actions taken by endpoint to apply the configurations for malware
            fields:
            - name: ingest_malware_config
              description: >
                Ingest the malware config from the policy application
              fields:
              - name: status
                description: >
                  The status of this action
                type: keyword
                example: success
              - name: message
                description: >
                  A message describing the status results
                type: text
                example: Malware mode: detect
            fields:
            - name: download_model 
              description: >
                Download the malware model
              fields:
              - name: status
                description: >
                  The status of this action
                type: keyword
                example: success
              - name: message
                description: >
                  A message describing the status results
                type: text
                example: Successfully downloaded EXE model, FP list, and FN list
            fields:
            - name: configure_malware 
              description: >
                Download the malware model
              fields:
              - name: status
                description: >
                  The status of this action
                type: keyword
                example: success
              - name: message
                description: >
                  A message describing the status results
                type: text
                example: Malware prevention enabled
            fields:
            - name: load_model 
              description: >
                Load the malware model
              fields:
              - name: status
                description: >
                  The status of this action
                type: keyword
                example: success
              - name: message
                description: >
                  A message describing the status results 
                type: text
                example: Successfully loaded EXE model, FN list, and FP list 
            #TODO Add the rest of the actions

        - name: eventing
          description: >
            The details of the application of the eventing configuration
          fields:
          - name: status
            description: >
              The status of the eventing configuration
            type: keyword
            example: failure
          - name: concerned_actions #TODO we can define each action
            description: >
              The actions taken by endpoint to apply the configurations for eventing
            fields: #TODO add the rest of the actions.

      - name: actions #TODO are there actions here worth showing that aren't applicable to any specific configuration?
        description: >
          The list of all actions taken by the endpoint to apply this policy
        fields:
        - name: version_check
          description: >
            A version check for the policy
          fields:
          - name: status
            description: >
              The status of this action
            type: keyword
            example: success
          - name: message
            description: >
              A message describing the status results
            type: text
            example: version not verified

        #TODO add more actions, we can define each one


- name: agent
  description: >
    The agent fields contain data about the Elastic Endpoint Agent (Endpoint Agent).
  fields:
  - name: version
    description: >
      version of the elastic endpoint agent.
    type: keyword
    example: 6.0.0-rc2

  - name: id
    description: >
      Unique identifier of this elastic endpoint agent (if one exists).
    type: keyword
    example: 8a4f500d
  
